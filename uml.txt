@startuml

class PlayerContext
{
    - fsm: readonly FSM<WeaponState>
    - IWeapon AssembleWeapon()
    - bindings: List<InputHander.Bindings>
    - void SetupStates(weapon: IWeapon)
}

class FSM<T>
{
    - states: readonly Dictionary<Type, T>
    -current: T
    + void AddState(state: T)
    + void RemoveState(state: T)
    + void TransitionTo(state: Type)
    + void TransitionTo(state: T)
    + void Update()
    + List<T> GetStates()
}

interface IDamagable
{
    + void Damage(amount: float)
}

interface IState 
{
    + void EnterState()
    + void Update()
    + void ExitState()
}

interface IWeapon 
{
    + string GetName()
    + float GetReloadTime()
    + int GetMaxBullets()
    + float GetDamage()
    + float GetShootInterval()
    + float GetMaxBulletRange()
    + float GetSpread()
    + AudioClip GetShootSound()
    + AudioClip GetReloadSound()
}


class BaseWeapon implements ScriptableObject, IWeapon
{

}

class WeaponDecorator implements ScriptableObject, IWeapon
{
    - weapon: IWeapon
    + IWeapon GetUnderlyingWeapon()
    + WeaponDecorator(weapon: IWeapon)
}

class SilencerDecorator implements WeaponDecorator
{
    + newSound: AudioClip
}

class ExtendedMagDecorator implements WeaponDecorator
{
    + bulletsGained: int
}

class SpreadDecorator implements WeaponDecorator
{
    + spread: float
}

class ReadyWeaponState implements WeaponState
{
    
}

class ReloadingWeaponState implements WeaponState
{
    
}

class ToggleDecoratorWeaponState implements WeaponState
{
    
}

PlayerContext ..> WeaponState
PoolableGameObject -- GameObjectPool
BaseWeapon --* PlayerContext
WeaponDecorator --* PlayerContext
FSM --* PlayerContext
IWeapon --* WeaponDecorator
FSM --* WeaponState
FSM ..> IState
InputHandler --* WeaponState
IWeapon --* WeaponState
InputHandler --* PlayerContext
GameObjectPool --* PlayerContext